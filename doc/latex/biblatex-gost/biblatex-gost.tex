% $Id$
\input glyphtounicode.tex           %these three lines are
\input glyphtounicode-cmr.tex       %needed for russian search/copy
\pdfgentounicode=1                  %(cmap)
\documentclass[11pt,headings=small,numbers=enddot]{ltxdockit}[2011/03/25]
%\usepackage[resetfonts]{cmap}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{btxdockit}
\usepackage[english,russian]{babel}
\usepackage[strict]{csquotes}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{booktabs}
%\usepackage{shortvrb}
%\usepackage{pifont}%  ???
\usepackage{indentfirst}
%---  fonts  ---
\usepackage{pscyr}
\renewcommand{\rmdefault}{fha}% Балтика
\renewcommand{\sfdefault}{far}% arial
%\usepackage{droid}   % not bad
%\usepackage{dejavu}  % ??

%\MakeAutoQuote{«}{»}
%\MakeAutoQuote*{<}{>}
%\MakeShortVerb{\|}

\usepackage{svn-multi}
\svnid{$Id$}

\hypersetup{unicode=true}

\newcommand*{\biber}{Biber\xspace}
\newcommand*{\biblatex}{Biblatex\xspace}
\newcommand*{\biblatexhome}{http://sourceforge.net/projects/biblatex/}
\newcommand*{\biblatexctan}{http://www.ctan.org/tex-archive/macros/latex/contrib/biblatex/}
\newcommand*{\biblatexgost}{Biblatex-GOST\xspace}
\newcommand*{\biblatexgosthome}{http://sourceforge.net/projects/biblatexgost/}

\svnRegisterRevision{16}{Версия 0.2}% to be used with \svnFullRevision*{\svnrev}
\svnRegisterRevision{64}{Версия 0.3}
\svnRegisterRevision{70}{Версия 0.3.1}
\svnRegisterRevision{79}{Версия 0.3.2}
\makeatletter
\providecommand*{\printtitlepage}{}
\renewrobustcmd*{\printtitlepage}{%
  \begingroup
  \centering\titlefont
  \begingroup\LARGE
    \ifundef\ltd@title@url
      {\ltd@title@title}
      {\href{\ltd@title@url}{\ltd@title@title}}%
    \par
  \endgroup
  \vspace{0.25\baselineskip}
  \begingroup\large
    \ltd@title@subtitle\par
  \endgroup
  \vspace{0.25\baselineskip}
  \begin{multicols}{2}
  \raggedleft
    \ltd@title@author\par
    \expandafter\email\expandafter{\ltd@title@email}\par
  \raggedright
    \ltd@title@revision\par\ltd@title@date 
  \end{multicols}
  \endgroup}
\makeatother

\titlepage{%
  title={Пакет \biblatexgost},
  subtitle={Оформление библиографии согласно ГОСТ 7.0.5-2008},
  url={\biblatexgosthome},
  author={Олег Доманов},
  email={odomanov@yandex.ru},
  revision={\svnFullRevision{\svnrev}},
  date={\svnday.\svnmonth.\svnyear}}

% TOC,LOT layout

\usepackage{tocloft}
\renewcommand*{\cftsecaftersnum}{.}
\renewcommand*{\cftsubsecaftersnum}{.}
\renewcommand*{\cfttabaftersnum}{.}
\setlength{\cftbeforesecskip}{0.25\baselineskip}
\setlength{\cftsecnumwidth}{2em}
\cftsetindents{subsection}{\cftsecindent}{\cftsecnumwidth}
\cftsetindents{table}{\cftsecindent}{\cftsecnumwidth}
\renewcommand*{\cftsubsecfont}{\sffamily\small}
\renewcommand*{\cftsecfont}{\bfseries\cftsubsecfont}
\renewcommand*{\cfttabfont}{\cftsubsecfont}
\renewcommand*{\cftsecpagefont}{\cftsecfont}
\renewcommand*{\cftsubsecpagefont}{\cftsubsecfont}
\renewcommand*{\cfttabpagefont}{\cfttabfont}

\hypersetup{%
  pdftitle={The \biblatexgost Package},
  pdfsubject={Bibliography according to Russian standards (GOST 7.0.5-2008)},
  pdfauthor={Oleg Domanov},
  pdfkeywords={tex, latex, bibtex, bibliography, references, citation, gost, russian}}

% tables

\newcolumntype{H}{>{\sffamily\bfseries\spotcolor}l}
\newcolumntype{L}{>{\raggedright\let\\=\tabularnewline}p}
\newcolumntype{R}{>{\raggedleft\let\\=\tabularnewline}p}
\newcolumntype{C}{>{\centering\let\\=\tabularnewline}p}
\newcolumntype{V}{>{\raggedright\let\\=\tabularnewline\ttfamily}p}

\newcommand*{\sorttablesetup}{%
  \tablesetup
  \ttfamily
  \def\new{\makebox[1.25em][r]{\ensuremath\rightarrow}\,}%
  \def\alt{\par\makebox[1.25em][r]{\ensuremath\hookrightarrow}\,}%
  \def\note##1{\textrm{##1}}}

\setcounter{secnumdepth}{4}

\hyphenation{%
}

\definecolor{reddish}{rgb}{0.6,0.2,0.2}
\newcommand*{\reddishcolor}{\color{reddish}}
%----- KOMA-script
\deffootnote[1.0em]{1.0em}{1.0em}{\makebox[0.7em][r]{\textsuperscript{\thefootnotemark}}~}
\addtokomafont{section}{\reddishcolor}
\addtokomafont{subsection}{\reddishcolor}
\renewcommand{\textfraction}{.5}
%-----
\usepackage{ellipsis}% must be loaded after hyperref !!
\newcommand{\bibsty}{\texttt}
\renewcommand*{\apxref}{\refs{прил.}{прил.}}
\renewcommand*{\Apxref}{\refs{Прил.}{Прил.}}
\renewcommand*{\tabref}{\refs{табл.}{табл.}}
\renewcommand*{\Tabref}{\refs{Табл.}{Табл.}}

\tolerance=9999

\newenvironment{bibexample}{\begin{list}{}{}}{\end{list}}

\begin{document}

\printtitlepage
\tableofcontents
\listoftables

\section{Введение}
\label{sec:int}

Пакет \biblatex{}\fnurl{http://www.ctan.org/tex-archive/macros/latex/contrib/biblatex/} 
предоставляет мощные и удобные средства автоматизации библиографии. 
Пакет \biblatexgost{}\fnurl{http://sourceforge.net/projects/biblatex-gost/} представляет 
собой набор стилей для \biblatex и предназначен для 
оформления библиографии согласно ГОСТ 7.0.5-2008. 
%Данная документация описывает отличия \biblatexgost как от \biblatex, так и 
%от ГОСТ. 
%Пакет, по возможности, совместим с пакетом GOST для Bibtex 
%Игоря Котельникова и Максима Полякова\fnurl{http://ctan.org/pkg/gost}.

\subsection{Установка}
\label{sec:install}

Пакет поставляется в виде архива, содержащего стандартую структуру дерева TDS. 
Для его установки достаточно распаковать архив в дерево \TeX, желательно локальное, и 
обновить индексы (в \TeX\ Live, например, это делается командой \texttt{mktexlsr}).

\subsection{Использование}
\label{sec:usage}

Работа со стилями \biblatexgost не отличается от работы с любыми другими стилями 
\biblatex. Например, в случае использования \sty{babel} ваш 
файл \latex может выглядеть примерно так:

\begin{lstlisting}[style=latex]
\documentclass{...}
\usepackage[french,latin,english,russian]{babel}
...
\usepackage[backend=biber,      % use biber instead of bibtex
  style=gost-footnote,          % bibliography and citation style
  language=auto,                % get main language from babel
  babel=other,                  % multilanguage bibliography
  ...
]{biblatex}
\addbibresource{biblatex-examples.bib}  % bibliographical database
...
\begin{document}

...\cite[123]{knuth:ct:a} ...           % cite your source

\printbibliography                      % print your bibliography

\end{document}

\end{lstlisting}

Подробности можно найти в документации по \biblatex{}\fnurl{http://www.ctan.org/tex-archive/macros/latex/contrib/biblatex/doc/biblatex.pdf}. \xelatex
официально не поддерживается, поскольку \biblatex{'ом} пока не поддерживается 
\sty{polyglossia}. Однако использование \sty{babel} совместно с \sty{xecyr}, 
похоже, не приводит ни к каким проблемам.

Для работы с \biblatexgost версии 0.4 и выше требуются \biblatex~2.0 и \biber~1.0beta.

\subsection{Лицензия}
\label{sec:lic}

Permission is granted to copy, distribute and\slash or modify this software under the terms of the \lppl, version 1.3.\fnurl{http://www.ctan.org/tex-archive/macros/latex/base/lppl.txt} This package is author"=maintained.


\section{Стили \biblatexgost}
\label{sec:styles}

ГОСТ определяет три типа ссылок: внутритекстовую, подстрочную, затекстовую.
Первые два типа приблизительно соответствуют стилям \bibsty{verbose} в \biblatex 
с опцией \opt{autocite}, установленной, соответственно, в \opt{inline} и 
\opt{footnote}. Затекстовые ссылки могут быть двух типов, в зависимости от 
способа отсылки к библиографии, которая в этом случае располагается \enquote{за текстом} 
--- в 
конце статьи, главы, книги и пр. В первом случае используются номера, во 
втором --- автор и год в квадратных скобках. В \biblatex им приблизительно 
соответствуют стили \bibsty{numeric} и \bibsty{authoryear}. В результате, 
стили \biblatexgost являются модификациями соответствующих базовых стилей 
\biblatex. 

Более конкретно, \biblatexgost содержит следующие стили.

\begin{marglist}

\item[gost-inline]
Внутритекстовые ссылки по ГОСТ. Является модификацией стандартного стиля 
\bibsty{verbose-trad3}. Ссылки помещаются внутри текста в круглых скобках. 
Стиль отслеживает
повторные ссылки, используя при необходимости короткие названия из поля
\bibfield{shorttitle}\footnote{О многоточиях при сокращении заголовков 
см.~\secref{sec:ellipsis}}.  
По умолчанию стиль устанавливает опции \kvopt{autocite}{inline}, \kvopt{sorting}{ntvy}, 
\kvopt{citetracker}{constrict}, \kvopt{citepages}{omit}, \kvopt{strict}{true}, 
\kvopt{opcittracker}{constrict}.

\item[gost-footnote]
Подстрочные ссылки по ГОСТ. Также является модификацией стандартного 
стиля \bibsty{verbose-trad3}. 
Стиль предназначен для помещения ссылок в сносках внизу страницы (с помощью 
команд \cmd{footcite}, \cmd{smartcite} или, ещё лучше, \cmd{autocite}, см.~\secref{sec:autocite}). 
По умолчанию стиль устанавливает опции \kvopt{autocite}{footnote}, \kvopt{sorting}{ntvy},
\kvopt{citetracker}{constrict}, \kvopt{citepages}{omit}, \kvopt{strict}{true}, 
\kvopt{opcittracker}{constrict}.

Фактически, стиль \bibsty{gost-footnote} имеет только два отличия от стиля 
\bibsty{gost-inline}. 
Во-первых, он устанавливает опцию \kvopt{autocite}{footnote}, что заставляет команду
\cmd{autocite} всегда выводить цитату в сноске 
(См. \secref{sec:citecommands}). Во-вторых, во внутритекстовой ссылке (но не 
в библиографии!) не выводятся, как того требует ГОСТ, серия и сведения, относящиеся 
к заглавию (поле \bibfield{titleaddon}, см.~\tabref{tab:gost-biblatex}). Кроме того,
там не выводятся поля \bibfield{doi}, 
\bibfield{eprint}, \bibfield{url}, \bibfield{addendum}, \bibfield{pubstate}. 

\item[gost-numeric]
Затекстовые ссылки по ГОСТ. Является модификацией стандартного стиля \bibsty{numeric-comp} и отличается от него лишь оформлением библиографии, но не цитат. Ссылки помещаются после текста, а для их связи с текстом используются числа в квадратных скобках. Стиль можно использовать в качестве только 
библиографического, указывая как стили цитирования стандартные стили \bibsty{numeric}, 
\bibsty{numeric-comp} и \bibsty{numeric-verb} и переопределив символ разделения ссылок на
точку с запятой:

\begin{lstlisting}[style=latex]
\renewcommand*{\multicitedelim}{\addsemicolon\space}
\end{lstlisting}

По умолчанию стиль устанавливает опции \kvopt{autocite}{inline}, \kvopt{sortcites}{true}.

\item[gost-authoryear]
Затекстовые ссылки по ГОСТ. Является модификацией стандартного 
стиля \bibsty{authoryear-icomp}. Ссылки помещаются после текста, и для их связи 
с текстом используются имя автора и год в квадратных скобках. При отсутствии автора
используется название или поле \bibfield{shorttitle}, если оно доступно. Нужно заметить, что ГОСТ 
допускает в этом случае неопределённые ссылки, например, в случаях, когда один автор имеет несколько 
работ одного года. Поэтому в \biblatexgost используется стандартный для других библиографических стилей 
метод добавления в случае необходимости маленькой латинской буквы к году. Буква добавляется как в 
ссылке, так и в библиографии. См. файл примеров. Это поведение можно отключить, для чего служит опция 
\opt{mergedate}.
По сравнению с \biblatex, она имеет два дополнительных значения \opt{gostletter} и 
\opt{goststrict} (см.~\secref{sec:opt}). Первое соответствует добавлению буквы к году, 
второе~"--- строгому 
следованию ГОСТу (хотя при этом существует опасность появления неопределённых ссылок).
По умолчанию стиль устанавливает опции \kvopt{autocite}{inline}, 
\kvopt{sorting}{nyt},
\kvopt{pagetracker}{true},
\kvopt{mergedate}{gostletter},
\kvopt{dashed}{false}. 

\end{marglist}

В ГОСТ определён ещё один тип затекстовых ссылок, при котором они связываются с текстом сносками. Этого 
можно достичь двумя способами. В первом используется стиль
\bibsty{gost-footnote} при наличии поддержки команды \cmd{endnote} (пакета \sty{endnotes}, стиля 
документа \sty{memoir} или других). При этом ссылки переносятся в конец текста (или главы, или в любое 
нужное место). Для этого должна быть установлена
опция \kvopt{notetype}{endonly}. Можно также воспользоваться 
пакетом \sty{fn2end}. Второй способ~--- использовать команду цитирования 
\cmd{supercite}, которая доступна только для стилей типа \bibsty{numeric} и
помещает номер в верхний индекс вместо квадратных скобок.

Дополнительно, все стили по умолчанию устанавливают опции 
\kvopt{isbn}{true},
\kvopt{url}{true},
\kvopt{doi}{true},
\kvopt{eprint}{true},
\kvopt{useeditor}{false},
\kvopt{usetranslator}{false},
\kvopt{maxnames}{3},
\kvopt{minnames}{1}.

\section{Соответствие терминов ГОСТ и \biblatexgost}
\label{sec:gost-biblatex}

Соответствие терминов ГОСТ и \biblatexgost представлено в \tabref{tab:gost-biblatex}. 
Как можно видеть, это соответствие неполное,
причём с обеих сторон.
Цветом выделены поля \biblatexgost, отсутствующие в \biblatex.

%\begin{table}[ht]
\begingroup
\sorttablesetup
\setlength\LTleft{0pt}
\setlength\LTright{0pt}
\begin{longtable}[l]{@{}V{0.5\textwidth}@{}V{0.5\textwidth}@{}}
\toprule
\multicolumn{1}{@{}H}{ГОСТ} &
\multicolumn{1}{@{}H}{\biblatexgost\hfill}  \\
\cmidrule(r){1-1}\cmidrule{2-2}
\endhead
\bottomrule
\endfoot
\endlastfoot
\multicolumn{1}{@{}H}{Область заглавия и} & \\
\multicolumn{1}{@{}H}{сведений об ответственности} & \\
\cmidrule(r){1-1}
Основное заглавие                & \bibfield{title}, \bibfield{subtitle},
                 \bibfield{maintitle}, \bibfield{mainsubtitle}, \bibfield{booktitle}, \bibfield{booksubtitle}, \\
\textit{Общее обозначение материала}      & \textendash \\
\textit{Параллельное заглавие}            & \textendash \\
\textit{Сведения, относящиеся к заглавию} & \bibfield{titleaddon}, \bibfield{maintitleaddon}, \bibfield{booktitleaddon} \\
Сведения об ответственности      & \bibfield{editor}, \bibfield{editora},
                                   \bibfield{editorb}, \bibfield{editorc}, 
                                   \bibfield{translator}, \bibfield{commentator}, 
                                   {\spotcolor\bibfield{credits}} \\
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область специфических сведений} & \bibfield{note} \\
\cmidrule(r){1-1}
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область издания} & \\
\cmidrule(r){1-1}
Сведения об издании & \bibfield{edition} \\
\textit{Параллельные сведения об издании} & \textendash \\
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область выходных данных} & \\
\cmidrule(r){1-1}
Место издания, распространения & \bibfield{location} \\
Имя издателя, распространителя и т.\,п. & \bibfield{publisher} \\
Дата издания, распространения и т.\,п. & \bibfield{date} \\
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область физической характеристики} & \\
\cmidrule(r){1-1}
Специфическое обозначение материала и объём & \bibfield{volumes}, \bibfield{pagetotal}, \bibfield{pages}, {\spotcolor\bibfield{books}}, {\spotcolor\bibfield{parts}}, {\spotcolor\bibfield{issues}}\\
\textit{Другие сведения о физической характеристике} & \textendash \\
\textit{Размеры} & \textendash \\
\textit{Сведения о сопроводительном материале} & \textendash \\
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область серии} & \\
\cmidrule(r){1-1}
Основное заглавие серии или подсерии & \bibfield{series} \\
\textit{Параллельное заглавие серии или подсерии} & \textendash \\
\textit{Сведения, относящиеся к заглавию серии или подсерии} & \textendash \\
Сведения об ответственности, относящиеся к заглавию серии или подсерии & \textendash \\
ISSN серии или подсерии & \textendash \\
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область примечания} & \\
\cmidrule(r){1-1}
\cmidrule(r){1-1}\cmidrule{2-2}
\multicolumn{1}{@{}H}{Область стандартного номера и} & \\
\multicolumn{1}{@{}H}{условий доступности} & \\
\cmidrule(r){1-1}
Стандартный номер (или его альтернатива) & \\
Ключевое заглавие & \textendash \\
Условия доступности и (или) цена & \textendash \\
Дополнительные сведения к элементам области & \textendash \\
\bottomrule
\caption{Соответствие терминов ГОСТ и \biblatex}\\
\label{tab:gost-biblatex}
\end{longtable}
%\end{table}
\endgroup

\section{Описание многотомных изданий}
\label{sec:multivol}

ГОСТ определяет два способа библиографического описания отдельного тома многотомного издания:

\begin{bibexample}
\item Детская энциклопедия. В 5 т. Т. 2. Человек. \dots\ 
\item Человек. \dots\ (Детская энциклопедия: в 5 т., т. 2)\dots\ 
\end{bibexample}

В \biblatexgost реализован только первый вариант. Соответственно, 
в стиле \bibsty{gost-autoryear} при отсутствии автора ссылка производится на общий 
заголовок многотомного издания, а не на заголовок отдельного тома (тем более, что 
последний может и отсутствовать):

\begin{bibexample}
\item{} [Детская энциклопедия, т.\,2, 2001, с.\,33]
\end{bibexample}

\section{Отличия от ГОСТ}
\label{sec:diff}

Отличия \biblatexgost от ГОСТ обусловлены двумя обстоятельствами.
1)~ГОСТ несовершенен. В некоторых
случаях, он допускает двусмысленность в ссылках. 2)~\biblatex несовершенен.
Некоторые требования ГОСТ не могут быть реализованы без внесения изменений в
ядро \biblatex'а. 
%Тем не менее, самые существенные требования ГОСТ соблюдены, и
%пакет, я надеюсь, уже в таком виде может быть полезен.

%По этим причинам \biblatexgost не во всём следует ГОСТ. Некоторые свойства более удачно
%реализованы средствами \biblatex, и было бы странно затрачивать усилия на то,
%чтобы эту реализацию ухудшить в угоду строгого соблюдения ГОСТ. 
Ниже перечислены отличия \biblatexgost от ГОСТ.

\begin{itemize}

\item В \biblatex нет понятия параллельного заглавия. Соответственно, его нет в 
\biblatexgost. В качестве обходного пути параллельное заглавие можно помещать в поля
\bibfield{titleaddon}, \bibfield{maintitleaddon}, \bibfield{booktitleaddon}. 

\item В \biblatex нет понятия общего обозначения материала. Соответственно, его нет в 
\biblatexgost. При необходимости, обозначение материала включается в поле \bibfield{title}, 
\bibfield{maintitle} и пр. 
(см.~\secref{sec:db:misc}).

\item В \biblatex нет понятия редактора серии и вообще того, что в ГОСТ относится к
сведениям об ответственности серии. Соответственно, ничего из этого не реализовано в 
\biblatexgost.

\item \ldots 

\end{itemize}

См. также~\apxref{sec:todo}.

\section{Команды цитирования}
\label{sec:citecommands}

Доступные команды цитирования перечислены в \tabref{tab:citecommands}. Их поведение
лишь в редких случаях отличается от стандартного, описанного в документации
\biblatex.
%Цветом выделены команды, поведение которых отличается от стандартного в \biblatex.

\begingroup
\sorttablesetup
\setlength\LTleft{0pt}
\setlength\LTright{0pt}
\begin{longtable}[l]{%
    @{}V{0.25\textwidth}%
    @{}V{0.25\textwidth}%
    @{}V{0.5\textwidth}@{}}
\toprule
\multicolumn{1}{@{}H}{Стиль} &
\multicolumn{1}{@{}H}{Команда} &
\multicolumn{1}{@{}H}{Вывод\hfill} \\
\cmidrule(r){1-1}\cmidrule(r){2-2}\cmidrule{3-3}
\endhead
\bottomrule
\endfoot
\endlastfoot
%\bibsty{Общие команды}
\bibsty{gost-inline} & \cmd{cite} & Только цитата в тексте без скобок \\
  & \cmd{parencite} & Цитата в тексте в круглых скобках \\
  & \cmd{footcite} & Цитата в сноске без скобок\\
  & \cmd{footcitetext} & То же, но используется \cmd{footnotetext} вместо \cmd{footnote} \\
  & \cmd{smartcite} & \cmd{footcite} в тексте, \cmd{parencite} в сноске. Другими словами, цитата всегда оказывается в сноске, но в первом случае в круглых скобках, во втором~"--- без них\\
  & \cmd{autocite} & Совпадает с \cmd{parencite} (установлена опция \kvopt{autocite}{inline})\\
\cmidrule(r){1-1}\cmidrule(r){2-2}\cmidrule{3-3}
\bibsty{gost-footnote} & \cmd{cite} & Только цитата в тексте без скобок \\
  & \cmd{parencite} & Цитата в тексте в круглых скобках \\
  & \cmd{footcite} & Цитата в сноске без скобок\\
  & \cmd{footcitetext} & То же, но используется \cmd{footnotetext} вместо \cmd{footnote} \\
  & \cmd{smartcite} & \cmd{footcite} в тексте, \cmd{parencite} в сноске. Другими словами, цитата всегда оказывается в сноске, но в первом случае в круглых скобках, во втором~"--- без них\\
  & \cmd{autocite} & Совпадает с \cmd{footcite} (установлена опция \kvopt{autocite}{footnote})\\
\cmidrule(r){1-1}\cmidrule(r){2-2}\cmidrule{3-3}
\bibsty{gost-numeric} & \cmd{cite} & Только номер, без скобок \\
  & \cmd{parencite} & Номер в квадратных скобках \\
  & \cmd{footcite} & Номер в сноске без скобок \\
  & \cmd{footcitetext} & То же, но используется \cmd{footnotetext} вместо \cmd{footnote} \\
  & \cmd{smartcite} & \cmd{footcite} в тексте, \cmd{parencite} в сноске. Другими словами, номер всегда оказывается в сноске, но в первом случае в квадратных скобках, во втором~"--- без них.\\
  & \cmd{textcite} & Номер в тексте без скобок \\
  & \cmd{supercite} & Номер как верхний индекс \\
  & \cmd{autocite} & Совпадает с \cmd{parencite} (установлена опция \kvopt{autocite}{inline})\\
\cmidrule(r){1-1}\cmidrule(r){2-2}\cmidrule{3-3}
\bibsty{gost-authoryear} & \cmd{cite} & Автор (заголовок) и год в тексте без скобок \\
  & \cmd{cite*} & Часть цитаты без автора (заголовка) в тексте без скобок \\
  & \cmd{parencite} & Автор (заголовок) и год в тексте в квадратных скобках \\
  & \cmd{parencite*} & Часть цитаты без автора (заголовка) в тексте 
в квадратных скобках \\
  & \cmd{footcite} & Автор (заголовок) и год в сноске без скобок \\
  & \cmd{footcitetext} & То же, но используется \cmd{footnotetext} вместо \cmd{footnote} \\
  & \cmd{smartcite} & \cmd{footcite} в тексте, \cmd{parencite} в сноске. Другими словами, цитата всегда оказывается в сноске, но в первом случае в квадратных скобках, во втором~"--- без них. \\
  & \cmd{textcite} & Автор (заголовок) без скобок и затем оставшаяся часть цитаты в квадратных скобках \\
  & \cmd{autocite} & Совпадает с \cmd{parencite} (установлена опция \kvopt{autocite}{inline})\\
\bottomrule
\caption{Поддерживаемые команды цитирования}\\
\label{tab:citecommands}
\end{longtable}
\endgroup
%\end{table}

Кроме перечисленных поддерживаются производные команды, описанные в 
 руководстве \biblatex, такие как \cmd{Cite}, \cmd{Parencite}, \dots\ \cmd{Cites}, 
\cmd{Footcites}, \dots\ \cmd{volcite}, \cmd{Volcites} и т.\,д. 

Хотя команды \cmd{textcite} и \cmd{textcites} в стилях \bibsty{gost-inline},
 \bibsty{gost-footnote} и \bibsty{gost-authoryear} вряд ли найдут применение
в русском тексте, они оставлены для полноты.

\subsection{Команда \cmd{autocite}}
\label{sec:autocite}

Команда \cmd{autocite} определена таким образом, чтобы\ldots

\section{Особенности заполнения базы данных}
\label{sec:database}

\subsection{Поля}
\label{sec:db:fields}

Имена в полях \bibfield{editor}, \bibfield{editora}, \bibfield{editorb}, \bibfield{editorc}, 
\bibfield{commentator}, \bibfield{translator}, \bibfield{afterword} и т.\,д. должны быть в 
родительном падеже: 
\enquote{Под ред. \prm{кого} А.\,Петрова}, \enquote{Пер. с фр. \prm{кого} И.\,Иванова}.

\begin{fieldlist}

\fielditem{credits}{literal}

Новое поле, см.~\secref{sec:biber}. Содержит организацию, выводимую 
в сведениях об ответственности.  Например:

\begin{bibexample}
\item \textellipsis\ \slash\ Академия наук СССР\ ;\ \textellipsis
\end{bibexample}

% FIXME: Возможно, лучше сделать editortype = organization ?

В этом же поле могут содержаться другие нестандартные сведения об ответственности,
например: <<авт. курса А. Сигалов>>,
<<коллектив авт. под рук. Исакова Ю.Ф>> и т.\,д. 
Более того, в особенно нестандартных ситуациях
оно может содержать вообще все сведения об ответственности. 
Поле \bibfield{credits} выводится в сведениях об ответственности в самом начале или 
сразу после авторов, если они там присутствуют. 

\fielditem{books, parts, issues}{literal}

Новые поля, см.~\secref{sec:biber}. Содержат количество книг, частей, выпусков многочастных изданий, 
которые делятся на книги, части, выпуски (аналогично стандартному полю \bibfield{volumes}). См.
также \secref{sec:volsparts}.

\fielditem{issue}{literal}

Выпуск. Для книг должно быть целым числом и выводится в форме «Вып.~3». Для журналов и 
другой периодики может быть литералом (например, Summer, Autumn и т.\,д.).
Подробнее см.~\secref{sec:serinjour}.

\fielditem{edition}{literal}

Сведения об издании. Если целое число, то выводится в виде «5-е изд.». Если литерал, выводится как есть. Например: <<издание 13-е, существенно переработанное>>.

\fielditem{series}{literal}

Для периодических изданий, таких как журналы, выводится в виде «3-я сер.», если
является целым числом. В противном случае, выводится как есть. См. также \secref{sec:serinjour}.

\fielditem{editortype}{key}

В \biblatexgost определён новый тип редактора \bibfield{editortype}=\{\bibfield{geneditor}\}, соответствующий общему редактору: \enquote{Под общ. ред. \ldots}.


\end{fieldlist}

\subsection[@periodical, @mvbook и сериальные
издания]{\bibtype{periodical}, \bibtype{mvbook} и сериальные издания}
\label{sec:db:series}

В ГОСТ различаются (6.3.4.2) сериальные документы с нумерацией по годам (как, например, в журналах) и со сквозной нумерацией. В первом случае не печатается дата на месте выходных данных. В \biblatexgost только такие документы соответствуют \bibtype{periodical}.  Сериальные документы со сквозной нумерацией рекомендуется оформлять как \bibtype{mvbook} или \bibtype{mvcollection}. 

\subsection{Серия в журналах}
\label{sec:serinjour}

Серия в журналах может пониматься в двух смыслах. 

Во-первых, она употребляется в
том же смысле, что и для книг, и также выводится в области серии в виде:

\begin{bibexample}
\item \textellipsis~"--- (Формальная семантика 78).~"--- \textellipsis
\end{bibexample}

При заполнении базы данных, эта серия помещается в поле \bibfield{series}.

Во-вторых, серия может входить в заглавие журнала: 

\begin{bibexample}
\item Известия Российской академии наук. Серия геологическая
\item Труды исторического факультета МГУ. Серия 4, Библиографии
\item Вестник Ивановского государственного университета. Серия «Химия, биология»
\item Итоги науки и техники. Серия: Автомобилестроение
\end{bibexample}

При заполнении базы данных, эта серия помещается в поле \bibfield{journaltitle}
вместе с названием журнала:

\begin{lstlisting}[style=bibtex,escapechar=|]
@ARTICLE{article,
  ...
  journaltitle = {|Итоги науки и техники. Серия: Автомобилестроение|},
}
\end{lstlisting}

\subsection{Многоточие при сокращении названий}
\label{sec:ellipsis}

Команда \cmd{textellipsis}, так же как и символ \enquote{…} (Unicode U+2026), в поле \bibfield{shorttitle} воспринимается \biblatex'ом
как конец предложения. Это может приводить к конфликтам с трекером пунктуации. 
По этой причине рекомендуется добавлять в таких случаях
команду \cmd{isdot}, превращающую
последнюю точку в точку сокращения (\texttt{dot}), а не конца предложения 
(\texttt{period}). Например: 
%xelatex, похоже, использует символ \enquote{…} (Unicode U+2026)

\begin{lstlisting}[style=bibtex,escapechar=|]
@BOOK{book,
  ...
  shorttitle = {|Введение|~\textellipsis\isdot}
}
\end{lstlisting}

Или:

\begin{lstlisting}[style=bibtex,escapechar=|]
@BOOK{book,
  ...
  shorttitle = {|Введение|~...\isdot}
}
\end{lstlisting}

Рекомендуется также использовать пакет
\sty{ellipsis} (его нужно загружать после пакета \sty{hyperref}).

\subsection{Электронные ресурсы}
\label{sec:elres}

Для электронных ресурсов в области специфических сведений содержатся вид и объём ресурса 
в виде: <<Вид (Объём)>> (см. ГОСТ 7.82-2001, п.5.5). Например:

\begin{bibexample}
\item \textellipsis~"--- Электрон, дан. (3 файла) и прогр. (2 файла).~"--- \textellipsis
\item \textellipsis~"--- Электрон, дан. (2 файла : 70 тыс. записей).~"--- \textellipsis
\item \textellipsis~"--- Электрон, прогр. (2 файла : 18650 байтов).~"--- \textellipsis
\item \textellipsis~"--- Electronic text data (2 files : 1.6 Mbytes).~"--- \textellipsis 
\end{bibexample} 

\subsection{Четыре и более имён}
\label{sec:db:4names}

При наличии 4-х и более имён авторов, редакторов, переводчиков и т.\,д. ГОСТ предоставляет 
выбор выводить ли их полный список или сокращать его до
одного имени с добавлением [et al.], [и др.] и пр. В \biblatex это поведение регулируется
опциями \opt{maxnames} и \opt{minnames}. В \biblatexgost они по умолчанию установлены в 3 и 1, 
соответственно, что означает, что при наличии более трёх имён в списке, он сокращается до 
одного.
При этом, даже при использовании опций \opt{useauthor}, \opt{useeditor} и \opt{usetranslator}
в качестве заголовка библиографической
записи используются не имена, а заглавие книги, статьи и т.\,д., сами же имена выводятся в сведениях
об ответственности:

\begin{bibexample}
\item Хорошая книга / И. Иванов [и др.]. --- \textellipsis
\end{bibexample}

 \biblatexgost отслеживает
количество имён в списке автоматически, 
однако механизм сортировки \biblatex не позволяет обнаружить, что в заголовке используются
не имена, а заглавие. Поэтому для правильной работы сортировки необходимо в базе данных для публикаций,
имеющих 4 и более имён, указывать в поле \bibfield{options} значение 
\kvopt{useauthor}{false} (при 4-х и более авторах), \kvopt{useeditor}{false} (при 4-х и более
редакторах), \kvopt{usetranslator}{false} (при 4-х и более переводчиках). Например:

\begin{lstlisting}[style=bibtex,escapechar=|]
@BOOK{book,
  author={|П. Первый| and |Н. Второй| and |А. Третий| and |И. Четвёртый|},
  options={useauthor=false},
  ...
}
\end{lstlisting}

К сожалению, если вы захотите изменить \opt{maxnames} (что, впрочем,
будет отступлением от ГОСТа), вам придётся изменить базу данных.
Если вы знаете способ это автоматизировать, соообщите, пожалуйста, мне.

\subsection{Другие особенности}
\label{sec:db:misc}

\begin{itemize}
\item Общее обозначение материала ([Электронный ресурс] и пр.) включается в заголовок:

\begin{lstlisting}[style=bibtex,escapechar=|]
title = {Google |[Электронный ресурс]|}
\end{lstlisting}

То же относится к параллельному заглавию.

\end{itemize}

\section{Отличия от стандартных стилей \biblatex}
\label{sec:stydiff}

\subsection{Тома, книги, части, выпуски}
\label{sec:volsparts}

Издание может делиться на физически отдельные части, которые могут называться по-разному. \biblatexgost поддерживает деление на тома, книги, части и выпуски (деление только одного уровня; например, тома, разделённые на части, не поддерживаются). Соответствующие им поля базы данных показаны в \tabref{tab:volsparts}.

\begin{table}
\tablesetup
\centering
\begin{tabularx}{.7\textwidth}{@{}p{.3\textwidth}@{}X@{}}
\toprule
\multicolumn{1}{@{}H}{Часть издания} &
\multicolumn{1}{@{}H}{Поле \biblatex}  \\
\cmidrule(r){1-1}\cmidrule{2-2}
тома & \bibfield{volume}, \bibfield{volumes} \\
книги & \bibfield{book}, \bibfield{books} \\
части & \bibfield{part}, \bibfield{parts} \\
выпуски & \bibfield{issue}\footnote{Поле \bibfield{issue} имеет особое значение в случае журналов. См. п. ??? руководства по \biblatex.}, \bibfield{issues} \\
\bottomrule
\end{tabularx}
\caption{Обозначение частей издания}
\label{tab:volsparts}
\end{table}

Если эти поля являются целыми числами, то они выводятся в виде: \enquote{В 5 т.},
\enquote{В 4 вып.} и т.\,д. В противном случае, они выводятся как есть: \enquote{В
5-и томах (6-и кн.)} и т.\,д. Строковые значения при занесении в базу данных следует 
писать со строчной буквы, \biblatexgost перейдёт на заглавные там, где требуется. Например:

\begin{lstlisting}[style=bibtex,escapechar=|]
volumes = {|в 5-и томах (6-и кн.)|}
\end{lstlisting}
 

\subsection{Даты в газетах и журналах}
\label{sec:jourdates}

Информация о дате в публикациях типа \bibtype{article} выводится в следующем порядке:

\begin{bibexample}
\item\textellipsis\ \prm{year}.~"--- \prm{day} \prm{month}.~"--- \prm{volume}, \prm{issue}, \prm{number}.~"--- \textellipsis
\end{bibexample}

Таким образом, для газет получается: 

\begin{bibexample}
\item\textellipsis\ 2001.~"--- 25 мая.~"--- \textellipsis
\end{bibexample}

И для журналов: 

\begin{bibexample}
\item\textellipsis\ 2001.~"--- №~1.~"--- \textellipsis
\item\textellipsis\ 2001.~"--- Т.~17.~"--- \textellipsis
\item\textellipsis\ 2001.~"--- Vol.~34, Summer, No.2.~"--- \textellipsis
\item\textellipsis\ 2001.~"--- July.~"--- Vol.~34.~"--- \textellipsis
\end{bibexample}


\subsection{Сортировка}
\label{sec:sorting}

В \biblatexgost определена новая схема сортировки \opt{ntvy} 
(имя, заглавие, том\slash книга\slash часть\slash выпуск, год). 
Она по умолчанию включена для стилей \bibsty{gost-inline}, \bibsty{gost-footnote}
и \bibsty{gost-numeric}.
Схема сортирует сначала по тому, затем, внутри тома, по книге, затем~--- по части, и 
затем~--- по выпуску.
Кроме того, поскольку стандартные схемы сортировки \biblatex плохо работают с многотомными
изданиями (неверно обрабатывается
поле \bibfield{maintitle}), то модифицированы схемы \opt{nty}, \opt{nyvt}, \opt{ynt}, 
\opt{ydnt} и \opt{nyt}. Кроме того, в них добавлена сортировка по 
тому\slash книге\slash части\slash выпуску. 
Схема \opt{nyt} (имя, год, заголовок) включена по умолчанию в стиле 
\bibsty{gost-authoryear}.

%\subsection{Типы публикаций}


\section{Опции}
\label{sec:opt}

Для всех стилей сохранены опции стандартных стилей \biblatex, от которых они происходят, даже если 
соответствующая функциональность не предполагается ГОСТом. Кроме того, пакет \sty{biblatex-gost} имеет 
следующие дополнительные опции.

\begin{optionlist}

\optitem[gostletter]{mergedate}{\opt{goststrict}, \opt{gostletter}}

Стиль \bibsty{gost-authoryear}, по сравнению со стандартным \bibsty{authoryear}, имеет два дополнительных значения опции \opt{mergedate}:
 
\begin{valuelist}

\item[gostletter]

Отключает в библиографии вывод года после автора (точнее, после \bibfield{label}). Для 
предотвращения неопределённых ссылок (например, при совпадении автора и года) к году при 
необходимости добавляется латинская буква. Эта функциональность не предусмотрена ГОСТом.

\item[goststrict]

Отключает в библиографии вывод года после автора (точнее, после \bibfield{label}). В 
отличие от предыдущей опции, никаких знаков к году не добавляется, что может приводить к 
неопределённым ссылкам, но зато точно соответствует требованиям ГОСТ.

\end{valuelist}

\optitem{sorting}{\opt{ntvy}}

В \biblatexgost определена дополнительная схема сортировки. См.~\secref{sec:sorting}.

\end{optionlist}

\section{Другие отличия}
\label{sec:otherdiff}

\ldots

\section{Известные проблемы}
\label{sec:issues}

\begin{itemize}
\item \ldots
\end{itemize}


\appendix
\section*{Приложения}
\addcontentsline{toc}{section}{Приложения}

\section{Детали реализации}
\label{sec:impldet}

\begin{itemize}
\item Определен макрос \cmd{ifmulticitation}, принимающий значение \texttt{True} 
внутри команд \cmd{...cites} (комплексных ссылок, в терминологии ГОСТ).

\item Пакет загружает дополнительный файл локализации
\linebreak\file{russian-gost.lbx}. В него добавлены строки \bibfield{books}, \bibfield{parts}, \bibfield{issues} для книг, частей, выпусков.

\item Имена авторов~--- 
а также редакторов или переводчиков при использовании опций \opt{useeditor} и/или 
\opt{usetranslator}~--- в заголовке библиографической записи 
по умолчанию выводятся курсивом. Этот формат можно изменить, 
переопределив команды
\cmd{mkbibhdnamelast}, \cmd{mkbibhdnamefirst}, \cmd{mkbibhdnameprefix} и 
\cmd{mkbibhdnameaffix}. По умолчанию, они определены так: 

\begin{lstlisting}[style=latex]
\newcommand*{\mkbibhdnamelast}[1]{\mkbibemph{#1}}
\newcommand*{\mkbibhdnamefirst}[1]{\mkbibhdnamelast{#1}}
\newcommand*{\mkbibhdnameprefix}[1]{\mkbibhdnamelast{#1}}
\newcommand*{\mkbibhdnameaffix}[1]{\mkbibhdnamelast{#1}} 
\end{lstlisting}

%\end{itemize}

%\subsection{Преобразование программой \biber}
%\label{sec:biber}

\item \biblatex не позволяет определять новые поля библиографической базы данных.
В то же время, пакет \biblatexgost определяет дополнительные поля для хранения количества 
книг, частей, выпусков многочастных изданий, а также название организации в сведениях об ответственности. В качестве этих полей можно использовать 
запасные поля \biblatex \bibfield{user[a-f]}, 
\bibfield{list[a-f]}, \bibfield{custom[a-f]} (см. п. 2.2.4 руководства \biblatex). В частности, для 
четырёх перечисленных параметров \biblatexgost использует, соответственно, поля 
\bibfield{userb}, \bibfield{userc}, \bibfield{userd} и \bibfield{lista}. 
При этом, однако, в базе данных 
содержатся более осмысленные названия полей, которые \biblatexgost (фактически, программа \biber
через механизм sourcemap)
автоматически преобразует во
внутренние поля \biblatex. 
Соответствие между полями в файле базы данных \file{.bib} и полями \biblatex показано в 
\tabref{tab:biber}.

\begin{table}
\tablesetup
\centering
\begin{tabularx}{.5\textwidth}{@{}p{.25\textwidth}@{}X@{}}
\toprule
\multicolumn{1}{@{}H}{Поле в базе \file{.bib}} &
\multicolumn{1}{@{}H}{Поле \biblatex}  \\
\cmidrule(r){1-1}\cmidrule{2-2}
%\bibfield{parttitle} & \bibfield{usera} \\
\bibfield{books} & \bibfield{userb} \\
\bibfield{parts} & \bibfield{userc} \\
\bibfield{issues} & \bibfield{userd} \\
\bibfield{credits} & \bibfield{lista} \\
\bottomrule
\end{tabularx}
\caption{Соответствие полей файла \file{.bib} и \biblatex}
\label{tab:biber}
\end{table}

%Чтобы воспользоваться этими заменами, нужно настроить \biber. Для этого нужно изменить 
%его файл конфигурации \file{biber.conf}. В простейшем случае, он
% может выглядеть следующим образом:
%
%\lstinputlisting[language=XML,basicstyle=\footnotesize\verbatimfont]{biber.conf.example}

\end{itemize}

\section{ChangeLog}
\label{apx:changelog}

\begin{changelog}

\begin{release}{0.3.2}{29-04-2012}
\item Исправлена ошибка опции \kvopt{citetracker}{constrict} в \bibsty{gost-inline},
\bibsty{gost-footnote}. Опция установлена по умолчанию.
\item Исправлено: не выводилось полное число томов, частей и т.\,д.
\item Исправлено: в цитатах \bibsty{gost-numeric} не переключался язык. 
\end{release}

\begin{release}{0.3.1}{21-04-2012}
\item Исправлены ошибки обработки опции dashed
\end{release}

\begin{release}{0.3}{18-04-2012}
\item Добавлена обработка длинных списков имён\see{sec:db:4names}
\item Добавлена схема сортировки \opt{ntvy}\see{sec:sorting}
\item Изменены некоторые стандартные схемы сортировки\see{sec:sorting}
\item Поля \bibfield{volume}, \bibfield{book}, \bibfield{part}, \bibfield{issue} 
теперь могут быть нечисловыми\see{sec:volsparts}
\item Добавлены макросы настройки формата имён заголовков\see{sec:impldet}
\item Восстановлена опция \opt{dashed} для \bibsty{gost-inline}, \bibsty{gost-footnote}
\item Исправлены ошибки в формате вывода авторов, редакторов, переводчиков
(в частности, для французского языка)
\item Исправлены ошибки сортировки многотомных изданий
\item Исправлен перевод терминов \bibfield{annotator}, \bibfield{withannotator}
\item Исправлены другие ошибки
\end{release}

\begin{release}{0.2}{12-02-2012}
\item Rearranged citation commands\see{sec:citecommands}
\item \texttt{gost-intext} renamed \texttt{gost-inline}\see{sec:styles}
\item Introduced \cmd{ifmulticitation} macro\see{sec:impldet}
\item Changed documentation
\end{release}

\begin{release}{0.1}{03-02-2012}
\item Initial
\end{release}

\end{changelog}

\section{TODO}
\label{sec:todo}

\begin{itemize}
\item электронные документы ([Электронный ресурс], систем. требования,\textellipsis)
\item комплексные ссылки: ... // Там же.~"--- требует проверки crossref
\item комплексные ссылки: ... // Её же., Его же,...~--- требует указания пола в БД
\item оформление стандартов
\item оформление патентов (поля: заявлено, опубликовано, приоритет,...)
%\item свед. о материале~"--- возможно, добавить в biber.conf
\item При составлении описания на документ в целом, если он продолжает публиковаться, приводят год издания первого номера и тире, после которого оставляют \textit{интервал в четыре пробела}: 

Долгопрудный : МФТИ, 1998~"--- \mbox{~~~~}.
\item серий может быть несколько~"--- выводятся друг за другом~"--- д.б. list?
\item Одно произведение в нескольких номерах журнала
\end{itemize}

\end{document}
